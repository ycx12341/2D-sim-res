ests <- foreach (i = 1:n.sims, .combine = rbind) %dopar% {
bcd.temp <- bcd(paras = paras.ecm.r1[i,], paras.ind = "ecm")
# Optional line: write the results into .rds files.
readr::write_rds(bcd.temp,
path = paste0("./", save.sims.dir, "/Round_1_paras", i, "_res.rds"))
c(i, bcd.temp)
}
toc()
stopCluster(cl)
# Clear the current workspace and load the necessary packages.
rm(list = ls())
library(doParallel)
library(doRNG)
library(tictoc)
library(readr)
# source functions
source("Automatic.R")
# Optional line: set the directory to store the simulation results in .rds
# files.
save.sims.dir <- "BCD_results_ecm_r1"
save.sims <- TRUE
if(save.sims) {
if(!dir.exists(save.sims.dir)) dir.create(save.sims.dir)
}
# Generate the initial parameters used in the evaluations of ECM density
# profile.
set.seed(123)
RNGkind(sample.kind = "Rejection")
dn<-runif(10000,0.000069,0.02)
gamma<-runif(10000,0.005,0.26)
eta<-runif(10000,7,18)
dm<-runif(10000,0.0001,0.033)
alpha<-runif(10000,0.07,0.18)
rn<-runif(10000,3.5,9)
paras.ecm.r1 <- cbind(dn,gamma,eta,dm,alpha,rn)
write.table(paras.ecm.r1,"Round 1 parameters 10000 ecm.txt")
paras.ecm.r1 <- as.matrix(read.table("Round 1 parameters 10000 ecm.txt", sep = "",
header = TRUE))
# Set up the parallel running scheme.
n.thread <- detectCores() - 1
n.sims <- 10000
cl <- makeCluster(n.thread)
registerDoParallel(cl)
tic()
ests <- foreach (i = 1:n.sims, .combine = rbind) %dopar% {
bcd.temp <- bcd(paras = paras.ecm.r1[i,], paras.ind = "ecm")
# Optional line: write the results into .rds files.
readr::write_rds(bcd.temp,
path = paste0("./", save.sims.dir, "/Round_1_paras", i, "_res.rds"))
c(i, bcd.temp)
}
toc()
stopCluster(cl)
View(ests)
write.table(ests, "bcd_ecm_r1.txt")
bcd.ecm.r1 <- unname(ests)
ind.nan.ecm.r1 <- which(is.na(bcd.ecm.r1[,2]))
bcd.ecm.r1.valid <- bcd.ecm.r1[-ind.nan.ecm.r1,]
mean(bcd.ecm.r1.valid[,2]) # 3.408093
min(bcd.ecm.r1.valid[,2]) # 0.02653616
# Resample and record the parameters to be evaluated in the next round.
paras.ecm.r2 <- abc.bcd(ss.mat = bcd.ecm.r1, paras = paras.ecm.r1, bw = 0.5)
# source functions
source("Automatic.R")
set.seed(123)
RNGkind(sample.kind = "Rejection")
paras.ecm.r2 <- abc.bcd(ss.mat = bcd.ecm.r1, paras = paras.ecm.r1, bw = 0.5)
write.table(paras.ecm.r2, "Round 2 parameters 10000 ecm.txt")
rm(list = ls())
library(readr)
library(latex2exp)
paras.d3 <- read_rds("Day 3 parameter estimates.rds")
setwd("D:/Academia/SCC cells simulation/Time dependent models")
rm(list = ls())
library(readr)
library(latex2exp)
paras.d3 <- read_rds("Day 3 parameter estimates.rds")
paras.d6 <- read_rds("Day 6 parameter estimates.rds")
paras.d9 <- read_rds("Day 9 parameter estimates.rds")
paras.d12 <- read_rds("Day 12 parameter estimates.rds")
paras.d14 <- read_rds("Day 14 parameter estimates.rds")
setwd("D:/Academia/SCC cells simulation/Time dependent models")
View(paras.d3)
paras.d3[["paras.day3.3runs"]]
View(paras.d6)
paras.d6[["paras.day6.final.est"]]
paras.d6[["paras.day6.3runs"]]
View(paras.d9)
paras.d9[["paras.day9.3runs"]]
View(paras.d12)
paras.d12[["paras.day12.3runs"]]
View(paras.d14)
paras.d14[["paras.day14.3runs"]]
paras.d3.final <- paras.d3$paras.day3.final.est
paras.d3.final.no.init.cols <- paras.d3.final[-7]
paras.d6.final <- paras.d6$paras.day6.final.est
paras.d9.final <- paras.d9$paras.day9.final.est
paras.d12.final <- paras.d12$paras.day12.final.est
paras.d14.final <- paras.d14$paras.day14.final.est
post.paras.est.mat <- rbind(paras.d3.final.no.init.cols,
paras.d6.final, paras.d9.final,
paras.d12.final, paras.d14.final)
colnames(post.paras.est.mat) <- c("dn.ests", "gamma.ests", "rn.ests", "eta.ests",
"dm.ests", "alpha.ests", "prop.death.ests",
"prop.mitosis.ests")
periods <- c(1,2,3,4,5)
periods.2 <- periods^2
post.paras.est.mat <- as.data.frame(cbind(periods, periods.2, post.paras.est.mat))
# Smooth fitting
# dn
dn.smooth.linear <- lm(dn.ests ~ periods, data = post.paras.est.mat)
dn.smooth.inter.only <- lm(dn.ests ~ 1, data = post.paras.est.mat)
dn.smooth.quad <- lm(dn.ests ~ periods + periods.2, data = post.paras.est.mat)
summary(dn.smooth.linear) # Adj-R^2 = 0.6533, linear coefficient is weakly significant
summary(dn.smooth.inter.only) # Coefficient is not significant.
summary(dn.smooth.quad) # Adj-R^2 = 0.7407, none of the parameters' coefficient is significant.
AIC(dn.smooth.linear) # -47.95767
AIC(dn.smooth.inter.only) # -43.22211
AIC(dn.smooth.quad) # -49.43654
periods.cont <- seq(0,5, by = 0.01)
fitted.vals.predict.dn.linear <- rep(0, length = length(periods.cont))
fitted.vals.predict.dn.inter.only <- rep(0, length = length(periods.cont))
fitted.vals.predict.dn.quad <- rep(0, length = length(periods.cont))
for (i in 1:length(periods.cont)) {
fitted.vals.predict.dn.linear[i] <- predict(dn.smooth.linear,
newdata = data.frame(periods = periods.cont[i]))
fitted.vals.predict.dn.inter.only[i] <- predict(dn.smooth.inter.only,
newdata = data.frame(periods = periods.cont[i]))
fitted.vals.predict.dn.quad[i] <- predict(dn.smooth.quad,
newdata = data.frame(periods = periods.cont[i],
periods.2 = periods.cont[i]^2))
}
plot(periods, post.paras.est.mat$dn.ests, pch = 19, cex = 2, col = "black",
bg = "black", xlab = "Periods",
ylab = TeX("Estimates of $d_{n}$"), main = TeX("Smoothing fits of $d_{n}$ estimates",
bold = TRUE))
lines(periods.cont, fitted.vals.predict.dn.linear, col = "red", lwd = 3)
lines(periods.cont, fitted.vals.predict.dn.inter.only, col = "blue", lwd = 3)
lines(periods.cont, fitted.vals.predict.dn.quad, col = "black", lwd = 3)
write.table(fitted.vals.predict.dn.inter.only, "Estimated values dn inter only.txt")
write.table(fitted.vals.predict.dn.linear, "Estimated values dn linear.txt")
write.table(fitted.vals.predict.dn.quad, "Estimated values dn quad.txt")
View(post.paras.est.mat)
post.paras.est.mat <- rbind(paras.d3.final.no.init.cols,
paras.d6.final, paras.d9.final,
paras.d12.final, paras.d14.final)
colnames(post.paras.est.mat) <- c("dn.ests", "gamma.ests", "rn.ests", "eta.ests",
"dm.ests", "alpha.ests", "prop.death.ests",
"prop.mitosis.ests")
View(post.paras.est.mat)
write.table(post.paras.est.mat, "Parameter estimates.txt")
periods <- c(1,2,3,4,5)
periods.2 <- periods^2
post.paras.est.mat <- as.data.frame(cbind(periods, periods.2, post.paras.est.mat))
dn.fitted.vals <- rbind(fitted.vals.predict.dn.inter.only,
fitted.vals.predict.dn.linear,
fitted.vals.predict.dn.quad)
write.table(dn.fitted.vals, "Estimated values dn.txt")
dn.fitted.vals <- cbind(fitted.vals.predict.dn.inter.only,
fitted.vals.predict.dn.linear,
fitted.vals.predict.dn.quad)
View(dn.fitted.vals)
write.table(dn.fitted.vals, "Estimated values dn.txt")
View(post.paras.est.mat)
# gamma
gamma.smooth.linear <- lm(gamma.ests ~ periods, data = post.paras.est.mat)
gamma.smooth.inter.only <- lm(gamma.ests ~ 1, data = post.paras.est.mat)
gamma.smooth.quad <- lm(gamma.ests ~ periods + periods.2, data = post.paras.est.mat)
summary(gamma.smooth.linear) # Adj-R^2 = 0.4572, none of the coefficients is significant.
summary(gamma.smooth.inter.only) # Moderate evidence that the coefficient is significant.
summary(gamma.smooth.quad) # Adj-R^2 = 0.8757, linear and quadratic coefficients are weakly significant.
AIC(gamma.smooth.linear) # -14.15931
AIC(gamma.smooth.inter.only) # -11.66556
AIC(gamma.smooth.quad) # -21.55722
fitted.vals.predict.gamma.linear <- rep(0, length = length(periods.cont))
fitted.vals.predict.gamma.inter.only <- rep(0, length = length(periods.cont))
fitted.vals.predict.gamma.quad <- rep(0, length = length(periods.cont))
for (i in 1:length(periods.cont)) {
fitted.vals.predict.gamma.linear[i] <- predict(gamma.smooth.linear,
newdata = data.frame(periods = periods.cont[i]))
fitted.vals.predict.gamma.inter.only[i] <- predict(gamma.smooth.inter.only,
newdata = data.frame(periods = periods.cont[i]))
fitted.vals.predict.gamma.quad[i] <- predict(gamma.smooth.quad, newdata = data.frame(periods = periods.cont[i],
periods.2 = periods.cont[i]^2))
}
plot(periods, post.paras.est.mat$gamma.ests, xlab = "Periods",
ylab = TeX("Estimates of $\\gamma$"), pch = 19, cex = 2,
col = "black", bg = "black",
main = TeX("Smoothing fits of $\\gamma$ estimates", bold = TRUE),
ylim = c(0, 0.16))
lines(periods.cont, fitted.vals.predict.gamma.linear, col = "red", lwd = 3)
lines(periods.cont, fitted.vals.predict.gamma.inter.only, col = "blue", lwd = 3)
lines(periods.cont, fitted.vals.predict.gamma.quad, col = "black", lwd = 3)
gamma.fitted.vals <- cbind(fitted.vals.predict.gamma.inter.only,
fitted.vals.predict.gamma.linear,
fitted.vals.predict.gamma.quad)
write.table(gamma.fitted.vals, "Estimated values gamma.txt")
periods.cont <- seq(0,5.5, by = 0.01)
fitted.vals.predict.dn.linear <- rep(0, length = length(periods.cont))
fitted.vals.predict.dn.inter.only <- rep(0, length = length(periods.cont))
fitted.vals.predict.dn.quad <- rep(0, length = length(periods.cont))
for (i in 1:length(periods.cont)) {
fitted.vals.predict.dn.linear[i] <- predict(dn.smooth.linear,
newdata = data.frame(periods = periods.cont[i]))
fitted.vals.predict.dn.inter.only[i] <- predict(dn.smooth.inter.only,
newdata = data.frame(periods = periods.cont[i]))
fitted.vals.predict.dn.quad[i] <- predict(dn.smooth.quad,
newdata = data.frame(periods = periods.cont[i],
periods.2 = periods.cont[i]^2))
}
plot(periods, post.paras.est.mat$dn.ests, pch = 19, cex = 2, col = "black",
bg = "black", xlab = "Periods",
ylab = TeX("Estimates of $d_{n}$"), main = TeX("Smoothing fits of $d_{n}$ estimates",
bold = TRUE))
lines(periods.cont, fitted.vals.predict.dn.linear, col = "red", lwd = 3)
lines(periods.cont, fitted.vals.predict.dn.inter.only, col = "blue", lwd = 3)
lines(periods.cont, fitted.vals.predict.dn.quad, col = "black", lwd = 3)
periods.cont <- seq(0,6, by = 0.01)
fitted.vals.predict.dn.linear <- rep(0, length = length(periods.cont))
fitted.vals.predict.dn.inter.only <- rep(0, length = length(periods.cont))
fitted.vals.predict.dn.quad <- rep(0, length = length(periods.cont))
for (i in 1:length(periods.cont)) {
fitted.vals.predict.dn.linear[i] <- predict(dn.smooth.linear,
newdata = data.frame(periods = periods.cont[i]))
fitted.vals.predict.dn.inter.only[i] <- predict(dn.smooth.inter.only,
newdata = data.frame(periods = periods.cont[i]))
fitted.vals.predict.dn.quad[i] <- predict(dn.smooth.quad,
newdata = data.frame(periods = periods.cont[i],
periods.2 = periods.cont[i]^2))
}
plot(periods, post.paras.est.mat$dn.ests, pch = 19, cex = 2, col = "black",
bg = "black", xlab = "Periods",
ylab = TeX("Estimates of $d_{n}$"), main = TeX("Smoothing fits of $d_{n}$ estimates",
bold = TRUE))
lines(periods.cont, fitted.vals.predict.dn.linear, col = "red", lwd = 3)
lines(periods.cont, fitted.vals.predict.dn.inter.only, col = "blue", lwd = 3)
lines(periods.cont, fitted.vals.predict.dn.quad, col = "black", lwd = 3)
plot(periods, post.paras.est.mat$dn.ests, pch = 19, cex = 2, col = "black",
bg = "black", xlim = c(0,6), xlab = "Periods",
ylab = TeX("Estimates of $d_{n}$"), main = TeX("Smoothing fits of $d_{n}$ estimates",
bold = TRUE))
lines(periods.cont, fitted.vals.predict.dn.linear, col = "red", lwd = 3)
lines(periods.cont, fitted.vals.predict.dn.inter.only, col = "blue", lwd = 3)
lines(periods.cont, fitted.vals.predict.dn.quad, col = "black", lwd = 3)
plot(periods, post.paras.est.mat$dn.ests, pch = 19, cex = 2, col = "black",
bg = "black", xlim = c(0.5,5.5), xlab = "Periods",
ylab = TeX("Estimates of $d_{n}$"), main = TeX("Smoothing fits of $d_{n}$ estimates",
bold = TRUE))
lines(periods.cont, fitted.vals.predict.dn.linear, col = "red", lwd = 3)
lines(periods.cont, fitted.vals.predict.dn.inter.only, col = "blue", lwd = 3)
lines(periods.cont, fitted.vals.predict.dn.quad, col = "black", lwd = 3)
dn.fitted.vals <- cbind(fitted.vals.predict.dn.inter.only,
fitted.vals.predict.dn.linear,
fitted.vals.predict.dn.quad)
write.table(dn.fitted.vals, "Estimated values dn.txt")
# gamma
gamma.smooth.linear <- lm(gamma.ests ~ periods, data = post.paras.est.mat)
gamma.smooth.inter.only <- lm(gamma.ests ~ 1, data = post.paras.est.mat)
gamma.smooth.quad <- lm(gamma.ests ~ periods + periods.2, data = post.paras.est.mat)
summary(gamma.smooth.linear) # Adj-R^2 = 0.4572, none of the coefficients is significant.
summary(gamma.smooth.inter.only) # Moderate evidence that the coefficient is significant.
summary(gamma.smooth.quad) # Adj-R^2 = 0.8757, linear and quadratic coefficients are weakly significant.
AIC(gamma.smooth.linear) # -14.15931
AIC(gamma.smooth.inter.only) # -11.66556
AIC(gamma.smooth.quad) # -21.55722
fitted.vals.predict.gamma.linear <- rep(0, length = length(periods.cont))
fitted.vals.predict.gamma.inter.only <- rep(0, length = length(periods.cont))
fitted.vals.predict.gamma.quad <- rep(0, length = length(periods.cont))
for (i in 1:length(periods.cont)) {
fitted.vals.predict.gamma.linear[i] <- predict(gamma.smooth.linear,
newdata = data.frame(periods = periods.cont[i]))
fitted.vals.predict.gamma.inter.only[i] <- predict(gamma.smooth.inter.only,
newdata = data.frame(periods = periods.cont[i]))
fitted.vals.predict.gamma.quad[i] <- predict(gamma.smooth.quad, newdata = data.frame(periods = periods.cont[i],
periods.2 = periods.cont[i]^2))
}
plot(periods, post.paras.est.mat$gamma.ests, xlab = "Periods",
ylab = TeX("Estimates of $\\gamma$"), pch = 19, cex = 2,
col = "black", bg = "black",
main = TeX("Smoothing fits of $\\gamma$ estimates", bold = TRUE),
ylim = c(0, 0.16))
plot(periods, post.paras.est.mat$gamma.ests, xlab = "Periods",
ylab = TeX("Estimates of $\\gamma$"), pch = 19, cex = 2,
col = "black", xlim = c(0.5, 5.5), bg = "black",
main = TeX("Smoothing fits of $\\gamma$ estimates", bold = TRUE),
ylim = c(0, 0.16))
lines(periods.cont, fitted.vals.predict.gamma.linear, col = "red", lwd = 3)
lines(periods.cont, fitted.vals.predict.gamma.inter.only, col = "blue", lwd = 3)
lines(periods.cont, fitted.vals.predict.gamma.quad, col = "black", lwd = 3)
gamma.fitted.vals <- cbind(fitted.vals.predict.gamma.inter.only,
fitted.vals.predict.gamma.linear,
fitted.vals.predict.gamma.quad)
write.table(gamma.fitted.vals, "Estimated values gamma.txt")
# rn estimates
rn.smooth.linear <- lm(rn.ests ~ periods,
data = post.paras.est.mat)
rn.smooth.inter.only <- lm(rn.ests ~ 1, data = post.paras.est.mat)
rn.smooth.quad <- lm(rn.ests ~ periods + periods.2, data = post.paras.est.mat)
summary(rn.smooth.linear) # 0.3457, intercept is moderately significant.
summary(rn.smooth.inter.only) # Coefficient is strongly significant.
summary(rn.smooth.quad) # 0.7227, none of the coefficient is significant.
AIC(rn.smooth.linear) # -31.68584
AIC(rn.smooth.inter.only) # -30.12646
AIC(rn.smooth.quad) # -36.00461
fitted.vals.predict.rn.linear <- rep(0, length = length(periods.cont))
fitted.vals.predict.rn.inter.only<- rep(0, length = length(periods.cont))
fitted.vals.predict.rn.quad <- rep(0, length = length(periods.cont))
for (i in 1:length(periods.cont)) {
fitted.vals.predict.rn.linear[i] <- predict(rn.smooth.linear,
newdata = data.frame(periods = periods.cont[i]))
fitted.vals.predict.rn.inter.only[i] <- predict(rn.smooth.inter.only,
newdata = data.frame(periods = periods.cont[i]))
fitted.vals.predict.rn.quad[i] <- predict(rn.smooth.quad, newdata = data.frame(periods = periods.cont[i],
periods.2 = periods.cont[i]^2))
}
plot(periods, post.paras.est.mat$rn.ests, xlab = "Periods",
ylab = TeX("Estimates of $r_{n}$"), pch = 19, col = "black",
bg = "purple", cex = 2,
main = TeX("Smoothing fits of $r_{n}$ estimates", bold = TRUE))
lines(periods.cont, fitted.vals.predict.rn.linear, col = "red", lwd = 3)
lines(periods.cont, fitted.vals.predict.rn.inter.only, col = "blue", lwd = 3)
lines(periods.cont, fitted.vals.predict.rn.quad, col = "black", lwd = 3)
plot(periods, post.paras.est.mat$rn.ests, xlab = "Periods",
ylab = TeX("Estimates of $r_{n}$"), pch = 19, col = "black",
bg = "purple", cex = 2, xlim = c(0.5, 5.5)
main = TeX("Smoothing fits of $r_{n}$ estimates", bold = TRUE))
lines(periods.cont, fitted.vals.predict.rn.linear, col = "red", lwd = 3)
plot(periods, post.paras.est.mat$rn.ests, xlab = "Periods",
ylab = TeX("Estimates of $r_{n}$"), pch = 19, col = "black",
bg = "purple", cex = 2, xlim = c(0.5, 5.5),
main = TeX("Smoothing fits of $r_{n}$ estimates", bold = TRUE))
lines(periods.cont, fitted.vals.predict.rn.linear, col = "red", lwd = 3)
lines(periods.cont, fitted.vals.predict.rn.inter.only, col = "blue", lwd = 3)
lines(periods.cont, fitted.vals.predict.rn.quad, col = "black", lwd = 3)
rn.fitted.vals <- cbind(fitted.vals.predict.rn.inter.only,
fitted.vals.predict.rn.linear,
fitted.vals.predict.rn.quad)
write.table(rn.fitted.vals, "Estimated values rn.txt")
# eta
eta.smooth.linear <- lm(eta.ests ~ periods,
data = post.paras.est.mat)
eta.smooth.inter.only <- lm(eta.ests ~ 1, data = post.paras.est.mat)
eta.smooth.quad <- lm(eta.ests ~ periods + periods.2, data = post.paras.est.mat)
summary(eta.smooth.linear) # 0.2614, intercept term is strongly significant.
summary(eta.smooth.inter.only) # Intercept is strongly significant.
summary(eta.smooth.quad) # 0.5901, intercept term is weakly significant.
AIC(eta.smooth.linear) # 25.01037
AIC(eta.smooth.inter.only) # 25.96406
AIC(eta.smooth.quad) # 22.03963
fitted.vals.predict.eta.linear <- rep(0, length = length(periods.cont))
fitted.vals.predict.eta.inter.only <- rep(0, length = length(periods.cont))
fitted.vals.predict.eta.quad <- rep(0, length = length(periods.cont))
for (i in 1:length(periods.cont)) {
fitted.vals.predict.eta.linear[i] <- predict(eta.smooth.linear,
newdata = data.frame(periods = periods.cont[i]))
fitted.vals.predict.eta.inter.only[i] <- predict(eta.smooth.inter.only,
newdata = data.frame(periods = periods.cont[i]))
fitted.vals.predict.eta.quad[i] <- predict(eta.smooth.quad, data.frame(periods = periods.cont[i],
periods.2 = periods.cont[i]^2))
}
plot(periods, post.paras.est.mat$eta.ests, xlab = "Periods",
ylim = c(11, 18), ylab = TeX("Estimates of $\\eta$"),
pch = 19, cex = 2, col = "black", bg = "black",
main = TeX("Smoothing fits of $\\eta$ estimates", bold = TRUE))
plot(periods, post.paras.est.mat$eta.ests, xlab = "Periods",
ylim = c(11, 18), ylab = TeX("Estimates of $\\eta$"),
pch = 19, cex = 2, col = "black", xlim = c(0.5, 5.5), bg = "black",
main = TeX("Smoothing fits of $\\eta$ estimates", bold = TRUE))
lines(periods.cont, fitted.vals.predict.eta.linear, col = "red", lwd = 3)
lines(periods.cont, fitted.vals.predict.eta.inter.only, col = "blue", lwd = 3)
lines(periods.cont, fitted.vals.predict.eta.quad, col = "black", lwd = 3)
eta.fitted.vals <- cbind(fitted.vals.predict.eta.inter.only,
fitted.vals.predict.eta.linear,
fitted.vals.predict.eta.quad)
write.table(eta.fitted.vals, "Estimated values eta.txt")
# dm
dm.smooth.linear <- lm(dm.ests ~ periods,
data = post.paras.est.mat)
dm.smooth.inter.only <- lm(dm.ests ~ 1, data = post.paras.est.mat)
dm.smooth.quad <- lm(dm.ests ~ periods + periods.2, data = post.paras.est.mat)
summary(dm.smooth.linear) # -0.2934, intercept term is strongly significant.
summary(dm.smooth.inter.only) # Strong evidence that the coefficient is significant.
summary(dm.smooth.quad) # -0.826, intercept term is weakly significant.
AIC(dm.smooth.linear) # -48.00336
AIC(dm.smooth.inter.only) # -49.85147
AIC(dm.smooth.quad) # -46.30652
fitted.vals.predict.dm.linear <- rep(0, length = length(periods.cont))
fitted.vals.predict.dm.inter.only <- rep(0, length = length(periods.cont))
fitted.vals.predict.dm.quad <- rep(0, length = length(periods.cont))
for (i in 1:length(periods.cont)) {
fitted.vals.predict.dm.linear[i] <- predict(dm.smooth.linear,
newdata = data.frame(periods = periods.cont[i]))
fitted.vals.predict.dm.inter.only[i] <- predict(dm.smooth.inter.only,
newdata = data.frame(periods = periods.cont[i]))
fitted.vals.predict.dm.quad[i] <- predict(dm.smooth.quad, newdata = data.frame(periods = periods.cont[i],
periods.2 = periods.cont[i]^2))
}
plot(periods, post.paras.est.mat$dm.ests, xlab = "Periods",
ylab = TeX("Estimates of $d_{m}$"), cex = 2, bg = "black",
pch = 19, col = "black",  xlim = c(0.5, 5.5)
main = TeX("Smoothing fits of $d_{m}$ estimates", bold = TRUE))
plot(periods, post.paras.est.mat$dm.ests, xlab = "Periods",
ylab = TeX("Estimates of $d_{m}$"), cex = 2, bg = "black",
pch = 19, col = "black",  xlim = c(0.5, 5.5),
main = TeX("Smoothing fits of $d_{m}$ estimates", bold = TRUE))
lines(periods.cont, fitted.vals.predict.dm.linear, col = "red", lwd = 3)
lines(periods.cont, fitted.vals.predict.dm.inter.only, col = "blue", lwd = 3)
lines(periods.cont, fitted.vals.predict.dm.quad, col = "black", lwd = 3)
dm.fitted.vals <- cbind(fitted.vals.predict.dm.inter.only,
fitted.vals.predict.dm.linear,
fitted.vals.predict.dm.quad)
write.table(dm.fitted.vals, "Estimated values dm.txt")
# alpha
alpha.smooth.linear <- lm(alpha.ests ~ periods,
data = post.paras.est.mat)
alpha.smooth.inter.only <- lm(alpha.ests ~ 1, data = post.paras.est.mat)
alpha.smooth.quad <- lm(alpha.ests ~ periods + periods.2, data = post.paras.est.mat)
summary(alpha.smooth.linear) # 0.3332, strong evidence that the intercept term is significant.
summary(alpha.smooth.inter.only) # Strong evidence that the intercept term is significant.
summary(alpha.smooth.quad) # 0.7791, the intercept term is strongly significant, the linea term is weakly significant.
AIC(alpha.smooth.linear) # -23.12725
AIC(alpha.smooth.inter.only) # -21.66243
AIC(alpha.smooth.quad) # -28.67872
fitted.vals.predict.alpha.linear <- rep(0, length = length(periods.cont))
fitted.vals.predict.alpha.inter.only <- rep(0, length = length(periods.cont))
fitted.vals.predict.alpha.quad <- rep(0, length = length(periods.cont))
for (i in 1:length(periods.cont)) {
fitted.vals.predict.alpha.linear[i] <- predict(alpha.smooth.linear,
newdata = data.frame(periods = periods.cont[i]))
fitted.vals.predict.alpha.inter.only[i] <- predict(alpha.smooth.inter.only,
newdata = data.frame(periods = periods.cont[i]))
fitted.vals.predict.alpha.quad[i] <- predict(alpha.smooth.quad,
newdata = data.frame(periods = periods.cont[i],
periods.2 = periods.cont[i]^2))
}
plot(periods, post.paras.est.mat$alpha.ests, xlab = "Periods",
ylab = TeX("Estimates of $\\alpha$"), ylim = c(0.09, 0.18), cex = 2,
col = "black", bg = "black", xlim = c(0.5,5.5),
pch = 19, main = TeX("Smoothing fits of $\\alpha$ estimates", bold = TRUE))
lines(periods.cont, fitted.vals.predict.alpha.linear, col = "red", lwd = 3)
lines(periods.cont, fitted.vals.predict.alpha.inter.only, col = "blue", lwd = 3)
lines(periods.cont, fitted.vals.predict.alpha.quad, col = "black", lwd = 3)
alpha.fitted.vals <- cbind(fitted.vals.predict.alpha.inter.only,
fitted.vals.predict.alpha.linear,
fitted.vals.predict.alpha.quad)
write.table(alpha.fitted.vals, "Estimated values alpha.txt")
# Prop.extinct
prop.ex.smooth.linear <- lm(prop.death.ests ~ periods,
data = post.paras.est.mat)
prop.ex.smooth.inter.only <- lm(prop.death.ests ~ 1,
data = post.paras.est.mat)
prop.ex.smooth.quad <- lm(prop.death.ests ~ periods + periods.2, data = post.paras.est.mat)
summary(prop.ex.smooth.linear) # -0.2809, intercept term is moderately significant.
summary(prop.ex.smooth.inter.only) # Strong evidence that the intercept term is significant.
summary(prop.ex.smooth.quad) # -0.6349, none of the coefficient is significant.
AIC(prop.ex.smooth.linear) # -28.65545
AIC(prop.ex.smooth.inter.only) # -30.45477
AIC(prop.ex.smooth.quad) # -27.46268
fitted.vals.predict.prop.ex.linear <- rep(0, length = length(periods.cont))
fitted.vals.predict.prop.ex.inter.only <- rep(0, length = length(periods.cont))
fitted.vals.predict.prop.ex.quad <- rep(0, length = length(periods.cont))
for (i in 1:length(periods.cont)) {
fitted.vals.predict.prop.ex.linear[i] <- predict(prop.ex.smooth.linear,
newdata = data.frame(periods = periods.cont[i]))
fitted.vals.predict.prop.ex.inter.only[i] <- predict(prop.ex.smooth.inter.only,
newdata = data.frame(periods = periods.cont[i]))
fitted.vals.predict.prop.ex.quad[i] <- predict(prop.ex.smooth.quad, newdata = data.frame(periods = periods.cont[i],
periods.2 = periods.cont[i]^2))
}
plot(periods, post.paras.est.mat$prop.death.ests, xlab = "Periods",
ylab = TeX("Estimates of $P_{ext.}$"), pch = 19, cex = 2,
col = "black", bg = "black",
main = TeX("Smoothing fits of $P_{ext.}$ estimates", bold = TRUE))
lines(periods.cont, fitted.vals.predict.prop.ex.linear, col = "red", lwd = 3)
lines(periods.cont, fitted.vals.predict.prop.ex.inter.only, col = "blue", lwd = 3)
lines(periods.cont, fitted.vals.predict.prop.ex.quad, col = "black", lwd = 3)
p.ext.fitted.vals <- cbind(fitted.vals.predict.prop.ex.inter.only,
fitted.vals.predict.prop.ex.linear,
fitted.vals.predict.prop.ex.quad)
write.table(p.ext.fitted.vals, "Estimated values P_ext.txt")
prop.prof.smooth.linear <- lm(prop.mitosis.ests ~ periods,
data = post.paras.est.mat)
prop.prof.smooth.inter.only <- lm(prop.mitosis.ests ~ 1,
data = post.paras.est.mat)
prop.prof.smooth.quad <- lm(prop.mitosis.ests ~ periods + periods.2, data = post.paras.est.mat)
summary(prop.prof.smooth.linear) # -0.2773, intercept term is weakly significant.
summary(prop.prof.smooth.inter.only) # Coefficient is strongly significant.
summary(prop.prof.smooth.quad) # 0.9274, moderate evidence that the linear and quadratic terms are significant.
AIC(prop.prof.smooth.linear) # 4.709535
AIC(prop.prof.smooth.inter.only) # 2.924205
AIC(prop.prof.smooth.quad) # -9.6583
fitted.vals.predict.prop.prof.linear <- rep(0, length = length(periods.cont))
fitted.vals.predict.prop.prof.inter.only <- rep(0, length = length(periods.cont))
fitted.vals.predict.prop.prof.quad <- rep(0, length = length(periods.cont))
for (i in 1:length(periods.cont)) {
fitted.vals.predict.prop.prof.linear[i] <- predict(prop.prof.smooth.linear,
newdata = data.frame(periods = periods.cont[i]))
fitted.vals.predict.prop.prof.inter.only[i] <- predict(prop.prof.smooth.inter.only,
newdata = data.frame(periods = periods.cont[i]))
fitted.vals.predict.prop.prof.quad[i] <- predict(prop.prof.smooth.quad, newdata = data.frame(periods = periods.cont[i],
periods.2 = periods.cont[i]^2))
}
plot(periods, post.paras.est.mat$prop.mitosis.ests, xlab = "Periods",
ylab = TeX("Estimates of $P_{mit.}$"), pch = 19, cex = 2, bg = "black",
main = TeX("Smoothing fits of $P_{mit.}$ estimates", bold = TRUE))
lines(periods.cont, fitted.vals.predict.prop.prof.linear, col = "red", lwd = 3)
lines(periods.cont, fitted.vals.predict.prop.prof.inter.only, col = "blue", lwd = 3)
lines(periods.cont, fitted.vals.predict.prop.prof.quad, col = "black", lwd = 3)
p.mit.fitted.vals <- cbind(fitted.vals.predict.prop.prof.inter.only,
fitted.vals.predict.prop.prof.linear,
fitted.vals.predict.prop.prof.quad)
write.table(p.mit.fitted.vals, "Estimated values P_mit.txt")
